import{I as ot,z as st,r as D,J as A,a as lt,A as C,w as nt,f as n,g as i,i as t,k as O,B as c,L as k,F as w,M as N,u as d,D as p,j as U,N as S,l as it,n as q,E as l,m as G,t as j}from"./index-e978c30f.js";import{g as ct,a as at,d as rt,b as R,c as dt,e as mt,f as ut,u as pt,_ as _t}from"./product-f52047eb.js";import{_ as ft}from"./ImgFeature02-b21e3eaf.js";import{_ as ht}from"./SideBar-9cffeaf8.js";import{_ as bt}from"./TheModal-6bc90acc.js";import{u as yt,a as xt}from"./formValidate-a0d0f42c.js";import{c as v}from"./catchError-23a142f6.js";import"./axios-15129f52.js";import"./LOGO_horizon-e3e3e605.js";const vt=ot("productAdminData",()=>{const h=st(),r=D([]),m=v(async()=>{h.isLoading=!0;const{data:a}=await ct();r.value=a,h.isLoading=!1}),b=v(async a=>{const{message:u}=await at(a);A(u),m()}),V=v(async a=>{const{message:u}=await rt(a);A(u),m()}),y=D([]),g=v(async()=>{h.isLoading=!0;const{data:a}=await R();y.value=a,h.isLoading=!1}),L=v(async a=>{h.isLoading=!0;const{productsType:u,priceLowerLimit:$,priceUpperLimit:T,amountStatus:P}=a,{data:f}=await R(u,$,T,P);y.value=f,h.isLoading=!1}),M=v(async a=>{const{message:u}=await dt(a);A(u),g()}),o=v(async a=>{const{message:u}=await mt(a.productNo,a);A(u),g()}),_=v(async a=>{const{message:u}=await ut(a.productNo);A(u),g()}),I=v(async a=>{h.isLoading=!0;const{data:u}=await pt(a);return h.isLoading=!1,u});return{dessertTypeList:r,productList:y,fetchGetDessertTypeList:m,fetchAddDessertcodes:b,fetchDeleteAdminDessertType:V,fetchAllProduct:g,fetchSearchProduct:L,fetchAddProduct:M,fetchEditProduct:o,fetchDeleteProduct:_,uploadFile:I}}),gt={class:"fixed top-0 left-0 z-40 w-[315px] h-screen"},kt={class:"ml-[315px] bg-white"},wt=t("nav",{class:"border-b-2 border-textself p-6"},[t("h1",{class:"flex items-center text-[36px] font-bold"},"商品管理")],-1),St={class:"min-h-screen p-6"},Tt={class:"flex-col xl:flex xl:flex-row items-end justify-between mb-3"},At={class:"flex items-end gap-4 mb-3"},Ct={class:"flex-col items-center"},Nt=t("label",{for:"filterCategory",class:"block mb-1 mr-3 font-medium whitespace-nowrap"},"商品分類",-1),Ut=["value"],Dt={class:"flex-col items-center"},Vt=t("label",{for:"filterStatus",class:"block mb-1 mr-3 font-medium whitespace-nowrap"},"狀態",-1),Pt=t("option",{value:"safe",selected:""},"安全",-1),Ft=t("option",{value:"danger"},"危險",-1),jt=t("option",{value:"zero"},"無庫存",-1),Lt=[Pt,Ft,jt],Mt={class:"flex flex-col"},It=t("label",{for:"filterPrice",class:"block mb-1 font-medium whitespace-nowrap"},"價格區間",-1),$t={class:"flex items-center mr-3"},zt=t("div",{class:"text-2xl align-middle mx-3"},"~",-1),Et=["onClick"],Bt={class:"flex items-center mb-3"},Ot={class:"grid grid-cols-12 gap-4"},qt=["onClick"],Gt=["src","alt"],Rt={class:"bg-neutralself-400 text-white rounded px-2 py-1 text-sm font-normal absolute top-36 left-5"},Jt={class:"text-2xl font-medium mb-3"},Ht={class:"flex justify-between items-center"},Kt={class:"text-primary-light text-[32px] font-bold"},Qt={class:"flex flex-col items-end"},Wt={key:0,class:"font-normal"},Xt=t("span",{class:"text-neutralself-200"},"剩餘",-1),Yt={key:1,class:"flex items-center text-primary-light font-normal"},Zt=t("img",{src:_t,class:"me-3",alt:"Img_IconDanger"},null,-1),te=t("span",{class:"text-neutralself-200"},"剩餘",-1),ee={key:2,class:"font-normal"},oe=t("span",{class:"text-neutralself-200"},"剩餘",-1),se={class:"font-normal"},le=t("span",{class:"text-neutralself-200"},"製作時間",-1),ne={key:0,class:"absolute top-0 bottom-0 left-0 right-0",style:{background:"rgba(8, 8, 8, 0.5)"}},ie={class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},ce={class:"text-2xl text-white font-medium py-6 px-9 whitespace-nowrap bg-textself rounded-lg"},ae={key:0,class:"text-center"},re=t("img",{src:ft,class:"object-cover block mx-auto",alt:"Feature_Card_Img2"},null,-1),de=t("p",{class:"font-medium"},"沒有相關條件的餐點喔！",-1),me=[re,de],ue={class:"relative bg-white border-2 border-textself rounded-lg shadow"},pe={class:"flex items-center justify-end border-b-2 border-textself p-3 rounded-t"},_e={key:0,class:"text-xl font-medium"},fe={key:1,class:"text-xl font-medium"},he={key:2,class:"text-xl font-medium"},be=t("svg",{"aria-hidden":"true",class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1),ye=t("span",{class:"sr-only text-black"},"Close modal",-1),xe=[be,ye],ve={class:"w-full rounded-lg p-3"},ge={key:0},ke={class:"grid grid-cols-2 gap-4"},we={class:"col-span-1"},Se={class:"mb-2"},Te=t("label",{for:"form_productName",class:"block font-medium"},"商品名稱",-1),Ae={class:"text-sm text-primary-light"},Ce={class:"mb-2"},Ne=t("label",{for:"form_productPrice",class:"block font-medium"},"商品訂價",-1),Ue={class:"text-sm text-primary-light"},De={class:"mb-2"},Ve=t("label",{for:"form_productImg",class:"block font-medium"},"商品圖片",-1),Pe={class:"flex flex-col"},Fe={class:"text-sm text-primary-light mb-2"},je=["src","alt"],Le={class:"col-span-1"},Me={class:"mb-2"},Ie=t("label",{for:"form_Stock",class:"block font-medium"},"商品庫存數量",-1),$e={class:"text-sm text-primary-light"},ze={class:"mb-2"},Ee=t("label",{for:"form_SafeStock",class:"block font-medium"},"安全庫存量",-1),Be={class:"text-sm text-primary-light"},Oe={class:"mb-2"},qe=t("label",{for:"form_time",class:"block font-medium"},"製作時間",-1),Ge={class:"flex items-center my-2"},Re=t("span",{class:"whitespace-nowrap"},"分鐘",-1),Je={class:"text-sm text-primary-light"},He={class:"mb-2"},Ke=t("label",{for:"selectStatus",class:"block font-medium whitespace-nowrap"},"商品分類",-1),Qe=["value"],We={class:"mb-2"},Xe=t("label",{for:"form_memberStatus",class:"block font-medium"},"狀態",-1),Ye=t("option",{value:!0,selected:""},"停用",-1),Ze=t("option",{value:!1},"啟用",-1),to=[Ye,Ze],eo={class:"mb-2"},oo=t("label",{for:"form_content",class:"block font-medium"},"商品描述",-1),so={class:"flex"},lo=["onClick"],no={key:1},io={class:"grid grid-cols-2 gap-4"},co={class:"col-span-1"},ao={class:"mb-2"},ro=t("label",{for:"form_productName",class:"block font-medium"},"商品名稱",-1),mo={class:"text-sm text-primary-light"},uo={class:"mb-2"},po=t("label",{for:"form_productPrice",class:"block font-medium"},"商品訂價",-1),_o={class:"text-sm text-primary-light"},fo={class:"mb-2"},ho=t("label",{for:"form_productImg",class:"block font-medium"},"商品圖片",-1),bo={class:"flex flex-col"},yo={class:"text-sm text-primary-light mb-2"},xo=["src","alt"],vo={class:"col-span-1"},go={class:"mb-2"},ko=t("label",{for:"form_Stock",class:"block font-medium"},"商品庫存數量",-1),wo={class:"text-sm text-primary-light"},So={class:"mb-2"},To=t("label",{for:"form_SafeStock",class:"block font-medium"},"安全庫存量",-1),Ao={class:"text-sm text-primary-light"},Co={class:"mb-2"},No=t("label",{for:"form_time",class:"block font-medium"},"製作時間",-1),Uo={class:"flex items-center my-2"},Do=t("span",{class:"whitespace-nowrap"},"分鐘",-1),Vo={class:"text-sm text-primary-light"},Po={class:"mb-2"},Fo=t("label",{for:"selectStatus",class:"block font-medium whitespace-nowrap"},"商品分類",-1),jo=["value"],Lo={class:"mb-2"},Mo=t("label",{for:"form_memberStatus",class:"block font-medium"},"狀態",-1),Io=t("option",{value:!0,selected:""},"停用",-1),$o=t("option",{value:!1},"啟用",-1),zo=[Io,$o],Eo=t("label",{for:"form_content",class:"block font-medium"},"商品描述",-1),Bo={class:"flex"},Oo=["onClick"],qo={key:2},Go=t("label",{for:"form_selectStatus",class:"block mb-2 font-medium"},"商品分類 (點擊黃色按鈕，即刻刪除該分類) ",-1),Ro={class:"text-sm text-primary-light mt-2"},Jo={class:"flex flex-wrap mt-3"},Ho=["onClick"],Ko=["onClick"],ls={__name:"ProductAdmin",setup(h){const r=vt();lt(()=>{r.fetchGetDessertTypeList(),r.fetchAllProduct()});const{errors:m,useFieldModel:b}=yt({validationSchema:xt}),V=C({productsTypeName:""}),y=C({productsTypeName:b("dessertCategory")}),g=()=>{r.fetchAddDessertcodes(y),Object.assign(y,V)},L=x=>{r.fetchDeleteAdminDessertType(x)},M=C({productNo:0,productName:"",photoUrl:"",price:0,inStockAmount:0,safeStockAmount:0,amountStatus:"safe",productsType:0,productionTime:0,isDisabled:!1,description:""}),o=C({productNo:0,productName:b("productName"),photoUrl:b("photoUrl"),price:b("price"),inStockAmount:b("inStockAmount"),safeStockAmount:b("safeStockAmount"),amountStatus:"safe",productsType:0,productionTime:b("productionTime"),isDisabled:!1,description:""}),_=C({productsType:"",priceLowerLimit:"",priceUpperLimit:"",amountStatus:""}),I=()=>{r.fetchSearchProduct(_)};nt([()=>_.productsType,()=>_.amountStatus],()=>{r.fetchSearchProduct(_)},{immediate:!0,deep:!0});const a=()=>{r.fetchAddProduct(o),F()},u=()=>{r.fetchEditProduct(o),F()},$=()=>{r.fetchDeleteProduct(o),F()},T=D(),P=()=>{const x=T.value.files[0],s=new FormData;s.append("file-to-upload",x),r.uploadFile(s).then(e=>{o.photoUrl=e.photoUrl})},f=D(!1),z=D(),E=(x,s)=>{f.value=x;const e=z.value;q(()=>{if(e&&e.openModal(),f.value==="updateProduct"){const{productNo:B,productName:J,photoUrl:H,price:K,inStockAmount:Q,safeStockAmount:W,amountStatus:X,isDisabled:Y,productionTime:Z,productsType:tt,description:et}=s;o.productNo=B,o.productName=J,o.photoUrl=H,o.price=K,o.inStockAmount=Q,o.safeStockAmount=W,o.amountStatus=X,o.isDisabled=Y,o.productionTime=Z,o.productsType=tt,o.description=et}})},F=()=>{const x=z.value;q(()=>{x&&(x.closeModal(),Object.assign(y,V),Object.assign(o,M))})};return(x,s)=>(n(),i(w,null,[t("aside",gt,[O(ht)]),t("div",kt,[wt,t("main",St,[t("div",Tt,[t("div",At,[t("section",Ct,[Nt,c(t("select",{id:"filterCategory",class:"form-select py-3","onUpdate:modelValue":s[0]||(s[0]=e=>_.productsType=e)},[(n(!0),i(w,null,N(d(r).dessertTypeList,e=>(n(),i("option",{key:e.productsType,value:e.productsType},l(e.productsTypeName),9,Ut))),128))],512),[[k,_.productsType]])]),t("section",Dt,[Vt,c(t("select",{id:"filterStatus",class:"form-select py-3","onUpdate:modelValue":s[1]||(s[1]=e=>_.amountStatus=e)},Lt,512),[[k,_.amountStatus]])]),t("section",Mt,[It,t("div",$t,[c(t("input",{type:"number",id:"filterPrice",class:"form-select py-3 max-w-[120px] xl:max-w-[200px]",required:"","onUpdate:modelValue":s[2]||(s[2]=e=>_.priceLowerLimit=e)},null,512),[[p,_.priceLowerLimit,void 0,{number:!0}]]),zt,c(t("input",{type:"number",id:"filterPriceTwo",class:"form-select py-3 max-w-[120px] xl:max-w-[200px]",required:"","onUpdate:modelValue":s[3]||(s[3]=e=>_.priceUpperLimit=e)},null,512),[[p,_.priceUpperLimit,void 0,{number:!0}]]),t("button",{onClick:U(I,["prevent"]),type:"button",class:"btn btn-outline-dark whitespace-nowrap mx-3"}," 搜尋 ",8,Et)])])]),t("section",Bt,[t("button",{onClick:s[4]||(s[4]=e=>E("create")),class:"btn btn-dark w-auto me-3"}," 新增商品 "),t("button",{onClick:s[5]||(s[5]=e=>E("updateCategory")),class:"btn btn-outline-dark w-auto"}," 編輯分類 ")])]),t("ul",Ot,[(n(!0),i(w,null,N(d(r).productList,e=>(n(),i("li",{onClick:B=>E("updateProduct",e),key:e.productNo,class:"col-span-12 xl:col-span-4 bg-white border-2 border-textself rounded-lg shadow relative"},[t("img",{class:"rounded-t-lg object-cover w-full h-[184px]",src:e.photoUrl,alt:e.productName},null,8,Gt),t("p",Rt,l(e.productsTypeName),1),t("div",{class:G(["transition-all duration-500 p-6 rounded-bl-lg rounded-br-lg",e.amountStatus==="safe"&&"bg-white",e.amountStatus==="danger"&&"bg-[#F31F1F1A]"])},[t("h2",Jt,l(e.productName),1),t("div",Ht,[t("p",Kt,"$"+l(e.price),1),t("div",Qt,[e.amountStatus==="safe"?(n(),i("p",Wt,[Xt,j("  "+l(e.inStockAmount)+"份 ",1)])):e.amountStatus==="danger"?(n(),i("p",Yt,[Zt,te,j("  "+l(e.inStockAmount)+"份 ",1)])):e.amountStatus==="zero"?(n(),i("p",ee,[oe,j("  "+l(e.inStockAmount)+"份 ",1)])):S("",!0),t("p",se,[le,j("  "+l(e.productionTime)+"分 ",1)])])])],2),e.isDisabled===!0||e.inStockAmount===0?(n(),i("section",ne,[t("div",ie,[t("p",ce,l(e.isDisabled===!0?"已停用":"已售完"),1)])])):S("",!0)],8,qt))),128))]),d(r).productList.length===0?(n(),i("div",ae,me)):S("",!0)])]),O(bt,{ref_key:"childComponentRef",ref:z},{default:it(()=>[t("section",{class:G(["relative w-full h-full max-w-md md:h-auto",f.value!=="updateCategory"&&"max-w-xl"])},[t("div",ue,[t("div",pe,[f.value==="create"?(n(),i("h2",_e,"新增商品")):f.value==="updateProduct"?(n(),i("h2",fe,"修改商品")):f.value==="updateCategory"?(n(),i("h2",he,"編輯分類")):S("",!0),t("button",{onClick:s[6]||(s[6]=e=>F()),type:"button",class:"text-gray-400 bg-black hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center"},xe)]),t("div",ve,[f.value==="create"?(n(),i("form",ge,[t("section",ke,[t("section",we,[t("div",Se,[Te,c(t("input",{type:"text",id:"form_productName",class:"form-input my-2","onUpdate:modelValue":s[7]||(s[7]=e=>o.productName=e)},null,512),[[p,o.productName,void 0,{trim:!0}]]),t("p",Ae,l(d(m).productName),1)]),t("div",Ce,[Ne,c(t("input",{type:"number",id:"form_productPrice",class:"form-input my-2","onUpdate:modelValue":s[8]||(s[8]=e=>o.price=e)},null,512),[[p,o.price,void 0,{number:!0}]]),t("p",Ue,l(d(m).price),1)]),t("div",De,[Ve,t("div",Pe,[t("input",{id:"form_productImg",ref_key:"imgFile",ref:T,type:"file",class:"form-input my-2",onChange:P},null,544),t("p",Fe,l(d(m).photoUrl),1),t("img",{src:o.photoUrl?o.photoUrl:"https://picsum.photos/id/365/300/300",alt:o.productName,class:"rounded-lg object-cover w-full h-[184px]"},null,8,je)])])]),t("section",Le,[t("div",Me,[Ie,c(t("input",{type:"number",id:"form_Stock",class:"form-input my-2","onUpdate:modelValue":s[9]||(s[9]=e=>o.inStockAmount=e)},null,512),[[p,o.inStockAmount,void 0,{number:!0}]]),t("p",$e,l(d(m).inStockAmount),1)]),t("div",ze,[Ee,c(t("input",{type:"number",id:"form_SafeStock",class:"form-input my-2","onUpdate:modelValue":s[10]||(s[10]=e=>o.safeStockAmount=e)},null,512),[[p,o.safeStockAmount,void 0,{number:!0}]]),t("p",Be,l(d(m).safeStockAmount),1)]),t("div",Oe,[qe,t("div",Ge,[c(t("input",{type:"text",id:"form_time",class:"form-input mr-2","onUpdate:modelValue":s[11]||(s[11]=e=>o.productionTime=e)},null,512),[[p,o.productionTime]]),Re]),t("p",Je,l(d(m).productionTime),1)]),t("div",He,[Ke,c(t("select",{id:"filterCategory",class:"form-select my-2","onUpdate:modelValue":s[12]||(s[12]=e=>o.productsType=e)},[(n(!0),i(w,null,N(d(r).dessertTypeList,e=>(n(),i("option",{key:e.productsType,value:e.productsType},l(e.productsTypeName),9,Qe))),128))],512),[[k,o.productsType]])]),t("div",We,[Xe,c(t("select",{id:"form_memberStatus",class:"form-select my-2","onUpdate:modelValue":s[13]||(s[13]=e=>o.isDisabled=e)},to,512),[[k,o.isDisabled]])]),t("div",eo,[oo,c(t("textarea",{id:"form_content",rows:"5",class:"form-input my-2","onUpdate:modelValue":s[14]||(s[14]=e=>o.description=e)},null,512),[[p,o.description,void 0,{trim:!0}]])])])]),t("div",so,[t("button",{onClick:U(a,["prevent"]),type:"submit",class:"w-full mr-1 btn btn-dark"}," 確定新增 ",8,lo)])])):S("",!0),f.value==="updateProduct"?(n(),i("form",no,[t("section",io,[t("section",co,[t("div",ao,[ro,c(t("input",{type:"text",id:"form_productName",class:"form-input my-2","onUpdate:modelValue":s[15]||(s[15]=e=>o.productName=e)},null,512),[[p,o.productName,void 0,{trim:!0}]]),t("p",mo,l(d(m).productName),1)]),t("div",uo,[po,c(t("input",{type:"number",id:"form_productPrice",class:"form-input my-2","onUpdate:modelValue":s[16]||(s[16]=e=>o.price=e)},null,512),[[p,o.price,void 0,{number:!0}]]),t("p",_o,l(d(m).price),1)]),t("div",fo,[ho,t("div",bo,[t("input",{id:"form_productImg",ref_key:"imgFile",ref:T,type:"file",class:"form-input my-2",onChange:P},null,544),t("p",yo,l(d(m).photoUrl),1),t("img",{src:o.photoUrl,alt:o.productName,class:"rounded-lg object-cover w-full h-[184px]"},null,8,xo)])])]),t("section",vo,[t("div",go,[ko,c(t("input",{type:"number",id:"form_Stock",class:"form-input my-2","onUpdate:modelValue":s[17]||(s[17]=e=>o.inStockAmount=e)},null,512),[[p,o.inStockAmount,void 0,{number:!0}]]),t("p",wo,l(d(m).inStockAmount),1)]),t("div",So,[To,c(t("input",{type:"number",id:"form_SafeStock",class:"form-input my-2","onUpdate:modelValue":s[18]||(s[18]=e=>o.safeStockAmount=e)},null,512),[[p,o.safeStockAmount,void 0,{number:!0}]]),t("p",Ao,l(d(m).safeStockAmount),1)]),t("div",Co,[No,t("div",Uo,[c(t("input",{type:"text",id:"form_time",class:"form-input mr-2","onUpdate:modelValue":s[19]||(s[19]=e=>o.productionTime=e)},null,512),[[p,o.productionTime]]),Do]),t("p",Vo,l(d(m).productionTime),1)]),t("div",Po,[Fo,c(t("select",{id:"filterCategory",class:"form-select my-2","onUpdate:modelValue":s[20]||(s[20]=e=>o.productsType=e)},[(n(!0),i(w,null,N(d(r).dessertTypeList,e=>(n(),i("option",{key:e.productsType,value:e.productsType},l(e.productsTypeName),9,jo))),128))],512),[[k,o.productsType]])]),t("div",Lo,[Mo,c(t("select",{id:"form_memberStatus",class:"form-select my-2","onUpdate:modelValue":s[21]||(s[21]=e=>o.isDisabled=e)},zo,512),[[k,o.isDisabled]])]),t("div",null,[Eo,c(t("textarea",{id:"form_content",rows:"5",class:"form-input my-2","onUpdate:modelValue":s[22]||(s[22]=e=>o.description=e)},null,512),[[p,o.description,void 0,{trim:!0}]])])])]),t("div",Bo,[t("button",{onClick:$,type:"button",class:"w-full mr-3 btn btn-outline-dark"}," 刪除 "),t("button",{onClick:U(u,["prevent"]),type:"submit",class:"w-full btn btn-dark"}," 確定修改 ",8,Oo)])])):f.value==="updateCategory"?(n(),i("form",qo,[t("div",null,[Go,c(t("input",{type:"text",id:"form_selectStatus",class:"form-input","onUpdate:modelValue":s[23]||(s[23]=e=>y.productsTypeName=e),placeholder:"請輸入分類"},null,512),[[p,y.productsTypeName,void 0,{trim:!0}]]),t("p",Ro,l(d(m).dessertCategory),1),t("div",Jo,[(n(!0),i(w,null,N(d(r).dessertTypeList,e=>(n(),i("button",{onClick:U(B=>L(e.productsType),["prevent"]),class:"btn btn-secondary font-medium my-2 mr-2 px-3 py-1 rounded",key:e.productsType},l(e.productsTypeName),9,Ho))),128))])]),t("button",{onClick:U(g,["prevent"]),type:"submit",class:"w-full btn btn-dark mt-3"}," 確定新增 ",8,Ko)])):S("",!0)])])],2)]),_:1},512)],64))}};export{ls as default};
