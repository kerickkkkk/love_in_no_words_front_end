import{I as O,z as R,r as y,J as S,a as J,A as M,f as n,g as a,i as e,k as j,j as x,F as q,M as G,u as p,N as v,l as H,E as r,B as m,D as f,L as C,t as F,n as $}from"./index-e978c30f.js";import{_ as K}from"./SideBar-9cffeaf8.js";import{_ as Q}from"./TheModal-6bc90acc.js";import{u as W,e as X}from"./formValidate-a0d0f42c.js";import{c as g}from"./catchError-23a142f6.js";import{g as B,b as Y,c as Z,f as ee}from"./user-e3118356.js";import"./LOGO_horizon-e3e3e605.js";import"./axios-15129f52.js";const te=O("userAdminData",()=>{const w=R(),u=y([]),_=y(null),N=g(async i=>{var l;w.isLoading=!0;const{data:d}=await B(i);_.value=(l=d.meta)==null?void 0:l.pagination.nextPage,u.value=d.usersList,u.value.forEach(b=>{c.value.push(b)}),w.isLoading=!1}),c=y([]),h=g(async i=>{var l;w.isLoading=!0;const{data:d}=await B(i);_.value=(l=d.meta)==null?void 0:l.pagination.nextPage,c.value=d.usersList,w.isLoading=!1}),L=g(async i=>{const{message:d}=await Y(i);S(d),h(1)}),t=g(async i=>{const d=i._id,{message:l}=await Z(d,i);S(l),h(1)}),V=g(async i=>{const d=i._id,l=i.titleNo,{message:b}=await ee(d,l);S(b),h(1)});return{userList:c,prePage:_,LoadNewFile:N,fetchUser:h,fetchAddUser:L,fetcheditUser:t,fetchDeleteUser:V}}),se={class:"fixed top-0 left-0 z-40 w-[315px] h-screen"},oe={class:"ml-[315px] bg-white"},le=e("nav",{class:"border-b-2 border-textself p-6"},[e("h1",{class:"flex items-center text-[36px] font-bold"},"使用者管理")],-1),ne={class:"min-h-screen p-6"},ae={class:"flex justify-end mb-6"},ie={class:"overflow-auto bg-bgself-light rounded-xl p-6"},de={class:"w-full text-center"},re=e("thead",{class:"text-xl font-medium text-secondary-light bg-textself"},[e("tr",{class:"border-b-2 border-black"},[e("th",{class:"py-3"},"姓名"),e("th",{class:"py-3"},"電話"),e("th",{class:"py-3"},"職位"),e("th",{class:"py-3"},"停用"),e("th",{class:"py-3"})])],-1),ce={class:"py-3"},me={class:"py-3"},ue={class:"py-3"},pe={class:"py-3"},_e={class:"flex justify-end items-center"},he=["onClick"],fe=["onClick"],be=e("span",{class:"text-xl lg:text-[28px] font-medium"},"點選以載入新資料",-1),ve=[be],xe={class:"relative w-full h-full max-w-md md:h-auto"},ye={class:"relative bg-white border-2 border-textself rounded-lg shadow"},we={class:"flex items-center justify-end border-b-2 border-textself p-3 rounded-t"},ke={key:0,class:"text-xl font-medium"},ge={key:1,class:"text-xl font-medium"},Ue={key:2,class:"text-xl font-medium"},Ce=e("svg",{"aria-hidden":"true",class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1),Ne=e("span",{class:"sr-only text-black"},"Close modal",-1),Le=[Ce,Ne],Ve={class:"w-full rounded-lg"},De={key:0,class:"space-y-3 p-3"},Ae=e("label",{for:"name",class:"block mb-2 font-medium"},"姓名",-1),Se={class:"text-sm text-primary-light mt-2"},Me=e("label",{for:"phone",class:"block mb-2 font-medium"},"電話",-1),je={class:"text-sm text-primary-light mt-2"},qe=e("label",{for:"job",class:"block mb-2 font-medium"},"職位",-1),Fe=e("option",{value:1,selected:""},"店長",-1),$e=e("option",{value:2},"店員",-1),Be=e("option",{value:3},"廚師",-1),Pe=e("option",{value:4},"會員",-1),Ee=[Fe,$e,Be,Pe],Ie={key:0},Te=e("label",{for:"email",class:"block mb-2 font-medium"},"信箱",-1),ze={class:"text-sm text-primary-light mt-2"},Oe={key:1},Re=e("label",{for:"password",class:"block mb-2 font-medium"},"密碼",-1),Je={class:"text-sm text-primary-light mt-2"},Ge=e("label",{for:"form_memberStatus",class:"block mb-2 font-medium"},"狀態",-1),He=e("option",{value:!0,selected:""},"停用",-1),Ke=e("option",{value:!1},"啟用",-1),Qe=[He,Ke],We=["onClick"],Xe={key:1,class:"space-y-3 p-3",action:"#"},Ye=e("label",{for:"name",class:"block mb-2 font-medium"},"姓名",-1),Ze={class:"text-sm text-primary-light mt-2"},et=e("label",{for:"phone",class:"block mb-2 font-medium"},"電話",-1),tt={class:"text-sm text-primary-light mt-2"},st=e("label",{for:"job",class:"block mb-2 font-medium"},"職位",-1),ot=e("option",{value:1},"店長",-1),lt=e("option",{value:2},"店員",-1),nt=e("option",{value:3},"廚師",-1),at=e("option",{value:4},"會員",-1),it=[ot,lt,nt,at],dt={key:0},rt=e("label",{for:"email",class:"block mb-2 font-medium"},"信箱",-1),ct={class:"text-sm text-primary-light mt-2"},mt={key:1},ut=e("label",{for:"password",class:"block mb-2 font-medium"},"密碼",-1),pt={class:"text-sm text-primary-light mt-2"},_t=e("label",{for:"form_memberStatus",class:"block mb-2 font-medium"},"狀態",-1),ht=e("option",{value:!0,selected:""},"停用",-1),ft=e("option",{value:!1},"啟用",-1),bt=[ht,ft],vt=["onClick"],xt={key:2,class:"space-y-3 p-3"},yt={class:"text-xl font-medium text-neutral-400"},wt={class:"text-primary-light"},kt=["onClick"],St={__name:"UserAdmin",setup(w){const u=te(),_=y(1),N=()=>{_.value++,u.LoadNewFile(_.value)};J(()=>{u.fetchUser(_.value),_.value=1});const{errors:c,useFieldModel:h}=W({validationSchema:X}),L=M({name:"",phone:"",password:"",email:""}),t=M({_id:"",name:h("name"),phone:h("phone"),titleNo:"1",isDisabled:!1,password:h("password"),email:h("email")}),V=()=>{u.fetchAddUser(t),U()},i=()=>{u.fetcheditUser(t),U()},d=()=>{u.fetchDeleteUser(t),U()},l=y(!1),b=y(),D=(k,o)=>{l.value=k;const s=b.value;$(()=>{if(s&&s.openModal(),l.value==="update"||l.value==="delete"){const{_id:A,name:P,phone:E,password:I,titleNo:T,isDisabled:z}=o;t._id=A,t.name=P,t.phone=E,t.titleNo=T,t.isDisabled=z,t.password=I,_.value=1}})},U=()=>{const k=b.value;$(()=>{k&&(k.closeModal(),Object.assign(t,L))})};return(k,o)=>(n(),a(q,null,[e("aside",se,[j(K)]),e("div",oe,[le,e("main",ne,[e("div",ae,[e("button",{onClick:o[0]||(o[0]=x(s=>D("create"),["prevent"])),class:"btn btn-dark whitespace-nowrap"}," 新增使用者 ")]),e("section",ie,[e("table",de,[re,e("tbody",null,[(n(!0),a(q,null,G(p(u).userList,s=>(n(),a("tr",{class:"border-b-2 border-black",key:s._id},[e("td",ce,r(s.name),1),e("td",me,r(s.phone),1),e("td",ue,r(s.title),1),e("th",pe,r(s.isDisabled?"停用":"啟用"),1),e("th",_e,[e("button",{onClick:x(A=>D("update",s),["prevent"]),class:"btn btn-outline-dark w-auto mx-1 my-2"}," 修改 ",8,he),e("button",{onClick:x(A=>D("delete",s),["prevent"]),class:"btn btn-outline-dark w-auto mx-1 my-2"}," 刪除 ",8,fe)])]))),128))])])]),p(u).prePage!==null?(n(),a("button",{key:0,type:"button",class:"w-full btn btn-secondary my-6",onClick:N},ve)):v("",!0)])]),j(Q,{ref_key:"childComponentRef",ref:b},{default:H(()=>[e("section",xe,[e("div",ye,[e("div",we,[l.value==="create"?(n(),a("h2",ke,"新增使用者資料")):l.value==="update"?(n(),a("h2",ge,"修改使用者資料")):l.value==="delete"?(n(),a("h2",Ue,"刪除使用者資料")):v("",!0),e("button",{onClick:o[1]||(o[1]=s=>U()),type:"button",class:"text-gray-400 bg-black hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center"},Le)]),e("div",Ve,[l.value==="create"?(n(),a("form",De,[e("div",null,[Ae,m(e("input",{type:"text",name:"name",id:"name",class:"form-input","onUpdate:modelValue":o[2]||(o[2]=s=>t.name=s),required:""},null,512),[[f,t.name,void 0,{trim:!0}]]),e("p",Se,r(p(c).name),1)]),e("div",null,[Me,m(e("input",{type:"text",name:"phone",id:"phone",class:"form-input","onUpdate:modelValue":o[3]||(o[3]=s=>t.phone=s),required:""},null,512),[[f,t.phone]]),e("p",je,r(p(c).phone),1)]),e("div",null,[qe,m(e("select",{id:"job",class:"form-select","onUpdate:modelValue":o[4]||(o[4]=s=>t.titleNo=s)},Ee,512),[[C,t.titleNo]])]),t.titleNo===1?(n(),a("div",Ie,[Te,m(e("input",{type:"email",name:"email",id:"email",class:"form-input","onUpdate:modelValue":o[5]||(o[5]=s=>t.email=s),required:""},null,512),[[f,t.email]]),e("p",ze,r(p(c).email),1)])):v("",!0),t.titleNo!==4?(n(),a("div",Oe,[Re,m(e("input",{type:"password",name:"password",id:"password",class:"form-input","onUpdate:modelValue":o[6]||(o[6]=s=>t.password=s),required:""},null,512),[[f,t.password]]),e("p",Je,r(p(c).password),1)])):v("",!0),e("div",null,[Ge,m(e("select",{id:"form_memberStatus",class:"form-select","onUpdate:modelValue":o[7]||(o[7]=s=>t.isDisabled=s)},Qe,512),[[C,t.isDisabled]])]),e("button",{onClick:x(V,["prevent"]),type:"submit",class:"w-full btn btn-dark"}," 確認新增 ",8,We)])):l.value==="update"?(n(),a("form",Xe,[e("div",null,[Ye,m(e("input",{type:"text",name:"name",id:"name",class:"form-input","onUpdate:modelValue":o[8]||(o[8]=s=>t.name=s),required:""},null,512),[[f,t.name,void 0,{trim:!0}]]),e("p",Ze,r(p(c).name),1)]),e("div",null,[et,m(e("input",{type:"text",name:"phone",id:"phone",class:"form-input","onUpdate:modelValue":o[9]||(o[9]=s=>t.phone=s),required:""},null,512),[[f,t.phone]]),e("p",tt,r(p(c).phone),1)]),e("div",null,[st,m(e("select",{id:"job",class:"form-select","onUpdate:modelValue":o[10]||(o[10]=s=>t.titleNo=s)},it,512),[[C,t.titleNo]])]),t.titleNo===1?(n(),a("div",dt,[rt,m(e("input",{type:"email",name:"email",id:"email",class:"form-input","onUpdate:modelValue":o[11]||(o[11]=s=>t.email=s),required:""},null,512),[[f,t.email]]),e("p",ct,r(p(c).email),1)])):v("",!0),t.titleNo!==4?(n(),a("div",mt,[ut,m(e("input",{type:"password",name:"password",id:"password",class:"form-input","onUpdate:modelValue":o[12]||(o[12]=s=>t.password=s),required:""},null,512),[[f,t.password]]),e("p",pt,r(p(c).password),1)])):v("",!0),e("div",null,[_t,m(e("select",{id:"form_memberStatus",class:"form-select","onUpdate:modelValue":o[13]||(o[13]=s=>t.isDisabled=s)},bt,512),[[C,t.isDisabled]])]),e("button",{onClick:x(i,["prevent"]),type:"submit",class:"w-full btn btn-dark"}," 確認修改 ",8,vt)])):l.value==="delete"?(n(),a("form",xt,[e("p",yt,[F(" 是否要刪除 "),e("span",wt,r(t.name),1),F(" 資料? ")]),e("button",{onClick:x(d,["prevent"]),type:"submit",class:"w-full btn btn-dark"}," 確認刪除 ",8,kt)])):v("",!0)])])])]),_:1},512)],64))}};export{St as default};
