import{I as E,z as T,r as D,K as O,J as N,a as P,A as W,f as l,g as n,i as e,k as j,F as f,M as C,u as h,l as R,n as F,t as _,E as c,m as q,N as V,B as x,D as I,j as L,L as A}from"./index-e978c30f.js";import{_ as J}from"./SideBar-9cffeaf8.js";import{_ as K}from"./TheModal-6bc90acc.js";import{b as G}from"./day-cea40187.js";import{u as H,e as Q}from"./formValidate-a0d0f42c.js";import{c as v}from"./catchError-23a142f6.js";import{g as X,b as Y,c as Z,f as ee}from"./seat-9b4bb4be.js";import"./LOGO_horizon-e3e3e605.js";import"./axios-15129f52.js";const te=E("seatAdminData",()=>{const p=T(),i=D([]),m=v(async()=>{p.isLoading=!0;const{data:a}=await X();a.length===0&&(O("尚未建立座位的資料"),p.isLoading=!1),i.value=a,p.isLoading=!1}),g=v(async a=>{const{message:r}=await Y(a);r==="成功"&&N("新增成功"),m()}),w=v(async(a,r)=>{const{message:y}=await Z(a,r);N(y),m()}),s=v(async a=>{const{message:r}=await ee(a);N(r),m()});return{seatList:i,getSeats:m,postSeat:g,patchSeat:w,delSeat:s}}),se={class:"fixed top-0 left-0 z-40 w-[315px] h-screen"},oe={class:"ml-[315px] bg-white"},ae=e("nav",{class:"border-b-2 border-textself p-6"},[e("h1",{class:"flex items-center text-[36px] font-bold"},"座位管理")],-1),le={class:"min-h-screen p-6"},ne={class:"flex justify-end mb-6"},ie={class:"grid grid-cols-12 gap-4"},de={class:"flex justify-between items-center border-b-2 border-textself px-4"},ce={class:"font-medium mb-5"},re={class:"text-white bg-primary-light rounded py-1 px-2 t"},me={class:"font-medium mb-5"},ue={class:"text-white bg-textself rounded py-1 px-2"},_e={class:"pl-4 pr-3 mt-4"},pe={class:"font-medium"},be={class:"ml-2"},fe={class:"font-medium"},he={class:"ml-2"},xe={class:"flex justify-between items-center mt-4"},ve={class:"flex justify-between items-center"},ge=["onClick"],we={class:"relative w-full h-full max-w-md md:h-auto"},ye={class:"relative bg-white border-2 border-textself rounded-lg shadow"},Se={class:"flex items-center justify-end border-b-2 border-textself p-3 rounded-t"},ke={key:0,class:"text-xl font-medium"},Ne={key:1,class:"text-xl font-medium"},Ce=e("svg",{"aria-hidden":"true",class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1),Le=e("span",{class:"sr-only text-black"},"Close modal",-1),Ae=[Ce,Le],De={class:"w-full rounded-lg p-3"},Me={key:0,class:"space-y-3",action:"#"},We=e("label",{for:"form_seatNumber",class:"block mb-2 font-medium"},"桌號 (點擊黃色按鈕，即刻刪除該桌號資料) ",-1),je={class:"text-sm text-primary-light mt-2"},Fe={class:"flex flex-wrap mt-3"},Ve=["onClick"],$e=["onClick"],Be={key:1,class:"space-y-3",action:"#"},ze={class:"flex justify-between items-center bg-bgself-light rounded-xl p-3 mb-3"},Ue={class:"font-medium"},Ee={class:"text-white bg-primary-light rounded py-1 px-2"},Te={class:"flex items-center"},Oe=e("label",{for:"form_seatPeopleLimit",class:"block font-medium whitespace-nowrap mr-1"},"人數",-1),Pe=["value"],Re=e("label",{for:"form_seatWindow",class:"block mb-2 font-medium"},"是否靠窗",-1),qe=e("option",{value:!1,selected:""},"否",-1),Ie=e("option",{value:!0},"是",-1),Je=[qe,Ie],Ke=e("label",{for:"form_seatStatus",class:"block mb-2 font-medium"},"狀態",-1),Ge=e("option",{value:!0,selected:""},"停用",-1),He=e("option",{value:!1},"啟用",-1),Qe=[Ge,He],nt={__name:"SeatAdmin",setup(p){const i=te();P(()=>{i.getSeats()});const{errors:m,useFieldModel:g}=H({validationSchema:Q}),w=W({_id:"",tableNo:1,tableName:"",seats:1,isWindowSeat:!1,isDisabled:!1,createdAt:""}),s=W({_id:"",tableNo:1,tableName:g("tableName"),seats:1,isWindowSeat:!1,isDisabled:!1,createdAt:""}),a=()=>{i.postSeat(s),b()},r=d=>{i.patchSeat(d,s),b()},y=d=>{i.delSeat(d),b()},u=D(!1),S=D(),M=(d,o)=>{u.value=d;const t=S.value;F(()=>{if(t&&t.openModal(),u.value==="update"){const{tableNo:k,tableName:$,seats:B,isWindowSeat:z,isDisabled:U}=o;s.tableNo=k,s.tableName=$,s.seats=B,s.isWindowSeat=z,s.isDisabled=U}})},b=()=>{const d=S.value;F(()=>{d&&(d.closeModal(),Object.assign(s,w))})};return(d,o)=>(l(),n(f,null,[e("aside",se,[j(J)]),e("div",oe,[ae,e("main",le,[e("div",ne,[e("button",{onClick:o[0]||(o[0]=t=>M("create")),class:"btn btn-dark whitespace-nowrap"}," 編輯桌號 ")]),e("ul",ie,[(l(!0),n(f,null,C(h(i).seatList,t=>(l(),n("li",{class:"col-span-12 lg:col-span-6 xl:col-span-4 py-4 bg-white border-2 border-textself rounded-xl shadow",key:t._id},[e("div",de,[e("p",ce,[_(" 桌號 "),e("span",re,c(t.tableName),1)]),e("p",me,[_(" 人數 "),e("span",ue,c(t.seats),1)])]),e("div",_e,[e("p",pe,[_(" 是否靠窗： "),e("span",be,c(t.isWindowSeat?"是":"否"),1)]),e("p",fe,[_(" 啟用日期： "),e("span",he,c(h(G)(t.createdAt)),1)]),e("div",xe,[e("p",{class:q(["rounded py-1 px-2",t.isDisabled?"bg-neutralself-100 text-white":"bg-secondary-light text-textself"])},c(t.isDisabled?"已停用":"已啟用"),3),e("div",ve,[e("button",{onClick:k=>M("update",t),type:"button",class:"btn btn-outline-dark mx-1"}," 修改 ",8,ge)])])])]))),128))])])]),j(K,{ref_key:"childComponentRef",ref:S},{default:R(()=>[e("section",we,[e("div",ye,[e("div",Se,[u.value==="create"?(l(),n("h2",ke,"編輯桌號")):u.value==="update"?(l(),n("h2",Ne,"修改座位資料")):V("",!0),e("button",{onClick:o[1]||(o[1]=t=>b()),type:"button",class:"text-gray-400 bg-black hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center"},Ae)]),e("div",De,[u.value==="create"?(l(),n("form",Me,[e("div",null,[We,x(e("input",{type:"number",name:"tableName",id:"form_seatNumber",class:"form-input",placeholder:"請輸入桌號","onUpdate:modelValue":o[2]||(o[2]=t=>s.tableName=t),required:""},null,512),[[I,s.tableName,void 0,{number:!0}]]),e("p",je,c(h(m).tableName),1),e("div",Fe,[(l(!0),n(f,null,C(h(i).seatList,t=>(l(),n("button",{type:"submit",class:"btn btn-secondary font-medium my-2 mr-2 px-3 py-1 rounded",key:t._id,onClick:L(k=>y(t.tableNo),["prevent"])},c(t.tableName),9,Ve))),128))])]),e("button",{type:"submit",class:"w-full btn btn-dark",onClick:L(a,["prevent"])}," 確定新增 ",8,$e)])):u.value==="update"?(l(),n("form",Be,[e("section",ze,[e("p",Ue,[_(" 桌號 "),e("span",Ee,c(s.tableName),1)]),e("div",Te,[Oe,x(e("select",{id:"form_seatPeopleLimit",class:"form-select py-1 rounded","onUpdate:modelValue":o[3]||(o[3]=t=>s.seats=t)},[(l(),n(f,null,C(20,t=>e("option",{key:t,value:t},c(t),9,Pe)),64))],512),[[A,s.seats]])])]),e("div",null,[Re,x(e("select",{id:"form_seatWindow",class:"form-select","onUpdate:modelValue":o[4]||(o[4]=t=>s.isWindowSeat=t)},Je,512),[[A,s.isWindowSeat]])]),e("div",null,[Ke,x(e("select",{id:"form_seatStatus",class:"form-select","onUpdate:modelValue":o[5]||(o[5]=t=>s.isDisabled=t)},Qe,512),[[A,s.isDisabled]])]),e("button",{type:"submit",class:"w-full btn btn-dark",onClick:o[6]||(o[6]=L(t=>r(s.tableNo),["prevent"]))}," 確認修改 ")])):V("",!0)])])])]),_:1},512)],64))}};export{nt as default};
