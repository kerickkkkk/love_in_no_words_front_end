import{I as J,z as X,r as _,K as Z,J as H,a as Q,f as l,g as a,i as e,F as A,M as O,E as p,u as g,k as E,l as Y,N as j,B as C,D as M,L as R,j as F,t as $,n as z,_ as G,v as ee,x as te,d as le,X as ne,e as ae,Y as K,Z as ce,$ as de}from"./index-e978c30f.js";import{_ as W}from"./TheModal-6bc90acc.js";import{u as se,b as oe}from"./formValidate-a0d0f42c.js";import{c as k}from"./catchError-23a142f6.js";import{a as ie,b as re,e as ue,d as pe,c as me,f as be,h as fe,i as he}from"./coupon-24bf0476.js";import{_ as _e}from"./SideBar-9cffeaf8.js";import"./axios-15129f52.js";import"./LOGO_horizon-e3e3e605.js";const ve=J("couponAdminData",()=>{const u=X(),c=_([]),r=k(async()=>{u.isLoading=!0;const{data:s}=await ie("cuponCode");s.length===0&&Z("尚未建立優惠碼活動"),c.value=s,u.isLoading=!1}),y=k(async s=>{const{message:n}=await re(s);H(n),r()}),t=k(async(s,n)=>{const{message:P}=await ue(s,n);H(P),r()}),m=k(async s=>{const{message:n}=await pe(s);H(n),r()});return{couponList:c,getCoupon:r,postCoupon:y,patchCoupon:t,delCoupon:m}}),ye=J("freebiePlusData",()=>{const u=X(),c=_([]),r=k(async()=>{u.isLoading=!0;const{data:s}=await me();s.list.length===0&&Z("尚未建立 A+B 活動"),c.value=s,u.isLoading=!1}),y=k(async s=>{const{message:n}=await be(s);H(n),r()}),t=k(async(s,n)=>{const{message:P}=await fe(s,n);H(P),r()}),m=k(async s=>{const{message:n}=await he(s);H(n),r()});return{freebiePlusList:c,getFreebiePlus:r,postFreebiePlus:y,patchFreebiePlus:t,delFreebiePlus:m}}),xe={class:"flex justify-end my-6"},ge={class:"overflow-auto bg-bgself-light rounded-xl p-6"},we={class:"w-full text-center"},Ce=e("thead",{class:"text-xl font-medium text-secondary-light bg-textself"},[e("tr",{class:"border-b-2 border-textself"},[e("th",{class:"py-3"},"優惠名稱"),e("th",{class:"py-3"},"優惠代碼"),e("th",{class:"py-3"},"折扣比例"),e("th",{class:"py-3"},"停用狀態"),e("th",{class:"py-3"})])],-1),$e={class:"py-3"},ke={class:"py-3"},Ne={class:"py-3"},Te={class:"py-3"},Me={class:"flex justify-end"},Fe=["onClick"],Ae=["onClick"],Pe={class:"relative w-full h-full max-w-md md:h-auto"},Le={class:"relative bg-white border-2 border-textself rounded-lg shadow"},je={class:"flex items-center justify-end border-b-2 border-textself p-3 rounded-t"},Be={key:0,class:"text-xl font-medium"},De={key:1,class:"text-xl font-medium"},Ve={key:2,class:"text-xl font-medium"},Se=e("svg",{"aria-hidden":"true",class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1),He=e("span",{class:"sr-only text-black"},"Close modal",-1),ze=[Se,He],Ie={class:"w-full rounded-lg p-3"},qe={key:0,class:"space-y-3",action:"#"},Ue=e("label",{for:"form_couponName",class:"block mb-2 font-medium"},"優惠名稱",-1),Oe={class:"text-sm text-primary-light mt-2"},Ze=e("label",{for:"form_couponCode",class:"block mb-2 font-medium"},"優惠代碼",-1),Ee={class:"text-sm text-primary-light mt-2"},Re=e("label",{for:"form_couponDiscount ",class:"block mb-2 font-medium"},"折扣比例",-1),Ye={class:"text-sm text-primary-light mt-2"},Ge=e("label",{for:"form_couponStatus",class:"block mb-2 font-medium"},"狀態",-1),We=e("option",{value:!0,selected:""},"停用",-1),Ke=e("option",{value:!1},"啟用",-1),Je=[We,Ke],Xe=["onClick"],Qe={key:1,class:"space-y-3",action:"#"},et=e("label",{for:"form_couponName",class:"block mb-2 font-medium"},"優惠名稱 ",-1),tt={class:"text-sm text-primary-light mt-2"},st=e("label",{for:"form_couponCode",class:"block mb-2 font-medium"},"優惠代碼 ",-1),ot={class:"text-sm text-primary-light mt-2"},lt=e("label",{for:"form_couponDiscount ",class:"block mb-2 font-medium"},"折扣比例 ",-1),nt={class:"text-sm text-primary-light mt-2"},at=e("label",{for:"form_couponStatus",class:"block mb-2 font-medium"},"狀態",-1),ct=e("option",{value:!0,selected:""},"停用",-1),dt=e("option",{value:!1},"啟用",-1),it=[ct,dt],rt=["onClick"],ut={key:2,class:"space-y-3",action:"#"},pt={class:"text-xl font-medium text-neutral-400"},mt={class:"text-primary-light"},bt=["onClick"],ft={__name:"CouponCode",setup(u){const c=ve();Q(()=>{c.getCoupon()});const{errors:r,useFieldModel:y}=se({validationSchema:oe}),t=_({couponName:y("couponName"),couponCode:y("couponCode"),discount:y("discount"),isDisabled:!1}),m=_(""),s=()=>{c.postCoupon(t.value),D()},n=()=>{c.patchCoupon(m.value,t.value),D()},P=()=>{c.delCoupon(m.value),D()},w=_(!1),I=_(),q=(T,d)=>{w.value=T;const o=I.value;z(()=>{if(o&&o.openModal(),w.value==="update"){const{couponNo:v,couponName:L,couponCode:U,discount:V,isDisabled:b}=d;t.value.couponName=L,t.value.couponCode=U,t.value.discount=V,t.value.isDisabled=b,m.value=v}if(w.value==="delete"){const{couponNo:v,couponName:L}=d;t.value.couponName=L,m.value=v}})},D=()=>{const T=I.value;z(()=>{T&&(T.closeModal(),t.value.couponName="",t.value.couponCode="",t.value.discount=0)})};return(T,d)=>(l(),a(A,null,[e("div",xe,[e("button",{onClick:d[0]||(d[0]=o=>q("create")),class:"btn btn-dark whitespace-nowrap"}," 新增優惠碼活動 ")]),e("section",ge,[e("table",we,[Ce,e("tbody",null,[(l(!0),a(A,null,O(g(c).couponList,o=>(l(),a("tr",{class:"border-b-2 border-textself",key:o._id},[e("td",$e,p(o.couponName),1),e("td",ke,p(o.couponCode),1),e("td",Ne,p(o.discount)+"%",1),e("td",Te,p(o.isDisabled?"已停用":"已啟用"),1),e("td",Me,[e("button",{onClick:v=>q("update",o),class:"btn btn-outline-dark w-auto mx-1 my-2"}," 修改 ",8,Fe),e("button",{onClick:v=>q("delete",o),class:"btn btn-outline-dark w-auto mx-1 my-2"}," 刪除 ",8,Ae)])]))),128))])])]),E(W,{ref_key:"childComponentRef",ref:I},{default:Y(()=>[e("section",Pe,[e("div",Le,[e("div",je,[w.value==="create"?(l(),a("h2",Be,"新增優惠活動")):w.value==="update"?(l(),a("h2",De,"修改優惠活動")):w.value==="delete"?(l(),a("h2",Ve,"刪除優惠活動")):j("",!0),e("button",{onClick:d[1]||(d[1]=o=>D()),type:"button",class:"text-gray-400 bg-black hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center"},ze)]),e("div",Ie,[w.value==="create"?(l(),a("form",qe,[e("div",null,[Ue,C(e("input",{type:"text",name:"couponName",id:"form_couponName",class:"form-input",placeholder:"請輸入優惠名稱","onUpdate:modelValue":d[2]||(d[2]=o=>t.value.couponName=o),required:""},null,512),[[M,t.value.couponName,void 0,{trim:!0}]]),e("p",Oe,p(g(r).couponName),1)]),e("div",null,[Ze,C(e("input",{type:"text",name:"couponCode",id:"form_couponCode",class:"form-input",placeholder:"請輸入優惠代碼","onUpdate:modelValue":d[3]||(d[3]=o=>t.value.couponCode=o),required:""},null,512),[[M,t.value.couponCode,void 0,{trim:!0}]]),e("p",Ee,p(g(r).couponCode),1)]),e("div",null,[Re,C(e("input",{type:"number",name:"discount",id:"form_couponDiscount",class:"form-input",placeholder:"請輸入折扣比例","onUpdate:modelValue":d[4]||(d[4]=o=>t.value.discount=o),required:""},null,512),[[M,t.value.discount,void 0,{number:!0}]]),e("p",Ye,p(g(r).discount),1)]),e("div",null,[Ge,C(e("select",{id:"form_couponStatus",class:"form-select","onUpdate:modelValue":d[5]||(d[5]=o=>t.value.isDisabled=o)},Je,512),[[R,t.value.isDisabled]])]),e("button",{type:"submit",class:"w-full btn btn-dark",onClick:F(s,["prevent"])}," 確定新增 ",8,Xe)])):w.value==="update"?(l(),a("form",Qe,[e("div",null,[et,C(e("input",{type:"text",name:"couponName",id:"form_couponName",class:"form-input",placeholder:"請輸入優惠名稱","onUpdate:modelValue":d[6]||(d[6]=o=>t.value.couponName=o),required:""},null,512),[[M,t.value.couponName,void 0,{trim:!0}]]),e("p",tt,p(g(r).couponName),1)]),e("div",null,[st,C(e("input",{type:"text",name:"couponCode",id:"form_couponCode",class:"form-input",placeholder:"請輸入優惠代碼","onUpdate:modelValue":d[7]||(d[7]=o=>t.value.couponCode=o),required:""},null,512),[[M,t.value.couponCode,void 0,{trim:!0}]]),e("p",ot,p(g(r).couponCode),1)]),e("div",null,[lt,C(e("input",{type:"number",name:"discount",id:"form_couponDiscount",class:"form-input",placeholder:"請輸入折扣比例","onUpdate:modelValue":d[8]||(d[8]=o=>t.value.discount=o),required:""},null,512),[[M,t.value.discount,void 0,{number:!0}]]),e("p",nt,p(g(r).discount),1)]),e("div",null,[at,C(e("select",{id:"form_couponStatus",class:"form-select","onUpdate:modelValue":d[9]||(d[9]=o=>t.value.isDisabled=o)},it,512),[[R,t.value.isDisabled]])]),e("button",{type:"submit",class:"w-full btn btn-dark",onClick:F(n,["prevent"])}," 確定修改 ",8,rt)])):w.value==="delete"?(l(),a("form",ut,[e("h3",pt,[$(" 請確認是否刪除 "),e("span",mt,p(t.value.couponName),1),$(" 優惠活動? ")]),e("button",{type:"submit",class:"w-full btn btn-dark",onClick:F(P,["prevent"])}," 確認刪除 ",8,bt)])):j("",!0)])])])]),_:1},512)],64))}};const x=u=>(ee("data-v-aab9e3f6"),u=u(),te(),u),ht={class:"flex justify-end my-6"},_t={class:"overflow-auto bg-bgself-light rounded-xl p-6"},vt={class:"w-full text-center"},yt=x(()=>e("thead",{class:"text-xl font-medium text-secondary-light bg-textself"},[e("tr",{class:"border-b-2 border-black"},[e("th",{class:"py-3"},"商品名稱"),e("th",{class:"py-3"},"優惠活動"),e("th",{class:"py-3"})])],-1)),xt={class:"border-b-2 border-black"},gt=x(()=>e("td",{class:"py-3 text-center"},"草莓蛋糕",-1)),wt=x(()=>e("td",{class:"py-3 text-center"},"買一送一",-1)),Ct={class:"flex justify-end"},$t={class:"border-b-2 border-black"},kt=x(()=>e("td",{class:"py-3 text-center"},"巧克力蛋糕",-1)),Nt=x(()=>e("td",{class:"py-3 text-center"},"買一送一",-1)),Tt={class:"flex justify-end"},Mt={class:"border-b-2 border-black"},Ft=x(()=>e("td",{class:"py-3 text-center"},"玫瑰馬卡龍",-1)),At=x(()=>e("td",{class:"py-3 text-center"},"買一送一",-1)),Pt={class:"flex justify-end"},Lt={class:"relative w-full h-full max-w-2xl md:h-auto"},jt={class:"relative bg-white border-2 border-textself rounded-lg shadow"},Bt={class:"flex items-center justify-end border-b-2 border-textself p-3 rounded-t"},Dt={key:0,class:"text-xl font-medium"},Vt={key:1,class:"text-xl font-medium"},St=x(()=>e("svg",{"aria-hidden":"true",class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)),Ht=x(()=>e("span",{class:"sr-only text-black"},"Close modal",-1)),zt=[St,Ht],It={class:"w-full rounded-lg p-3"},qt={key:0,class:"space-y-3",action:"#"},Ut=x(()=>e("ul",{class:"flex text-xl font-medium"},[e("li",{class:"mr-2"},[e("a",{href:"#",class:"block px-6 py-3 rounded-lg hover:text-primary-light hover:bg-white tabbar-active"},"全部")]),e("li",{class:"mr-2"},[e("a",{href:"#",class:"block px-6 py-3 rounded-lg hover:text-primary-light hover:bg-white"},"泡芙")]),e("li",{class:"mr-2"},[e("a",{href:"#",class:"block px-6 py-3 rounded-lg hover:text-primary-light hover:bg-white"},"聖代")]),e("li",{class:"mr-2"},[e("a",{href:"#",class:"block px-6 py-3 rounded-lg hover:text-primary-light hover:bg-white"},"蛋糕")]),e("li",{class:"mr-2"},[e("a",{href:"#",class:"block px-6 py-3 rounded-lg hover:text-primary-light hover:bg-white"},"氣泡水")]),e("li",{class:"mr-2"},[e("a",{href:"#",class:"block px-6 py-3 rounded-lg hover:text-primary-light hover:bg-white"},"其他")])],-1)),Ot=x(()=>e("section",{class:"h-[300px] overflow-y-auto"},[e("ul",{class:"grid grid-cols-12 gap-4"},[e("li",{class:"col-span-4 bg-white border-2 border-textself rounded-lg shadow"},[e("div",{class:"relative"},[e("img",{class:"rounded-t-lg object-cover w-full h-[120px]",src:"https://images.unsplash.com/photo-1551024601-bec78aea704b?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8Mnx8ZGVzc2VydHxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=800&q=60",alt:"ImgProduct"}),e("p",{class:"bg-secondary-light px-2 py-1 text-sm font-normal absolute bottom-2 left-2"}," 甜點 ")]),e("div",{class:"p-3 rounded-bl-lg rounded-br-lg"},[e("h2",{class:"font-medium mb-3"},"香草鮮奶酪"),e("div",{class:"flex justify-between items-center"},[e("p",{class:"text-primary-light font-bold"},"$80"),e("p",{class:"font-normal"},[e("span",{class:"text-neutralself-200"},"庫存"),$("  5份 ")])])])]),e("li",{class:"col-span-4 bg-white border-2 border-textself rounded-lg shadow"},[e("div",{class:"relative"},[e("img",{class:"rounded-t-lg object-cover w-full h-[120px]",src:"https://images.unsplash.com/photo-1551024601-bec78aea704b?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8Mnx8ZGVzc2VydHxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=800&q=60",alt:"ImgProduct"}),e("p",{class:"bg-secondary-light px-2 py-1 text-sm font-normal absolute bottom-2 left-2"}," 甜點 ")]),e("div",{class:"p-3 rounded-bl-lg rounded-br-lg"},[e("h2",{class:"font-medium mb-3"},"香草鮮奶酪"),e("div",{class:"flex justify-between items-center"},[e("p",{class:"text-primary-light font-bold"},"$80"),e("p",{class:"font-normal"},[e("span",{class:"text-neutralself-200"},"庫存"),$("  5份 ")])])])]),e("li",{class:"col-span-4 bg-white border-2 border-textself rounded-lg shadow"},[e("div",{class:"relative"},[e("img",{class:"rounded-t-lg object-cover w-full h-[120px]",src:"https://images.unsplash.com/photo-1551024601-bec78aea704b?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8Mnx8ZGVzc2VydHxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=800&q=60",alt:"ImgProduct"}),e("p",{class:"bg-secondary-light px-2 py-1 text-sm font-normal absolute bottom-2 left-2"}," 甜點 ")]),e("div",{class:"p-3 rounded-bl-lg rounded-br-lg"},[e("h2",{class:"font-medium mb-3"},"香草鮮奶酪"),e("div",{class:"flex justify-between items-center"},[e("p",{class:"text-primary-light font-bold"},"$80"),e("p",{class:"font-normal"},[e("span",{class:"text-neutralself-200"},"庫存"),$("  5份 ")])])])]),e("li",{class:"col-span-4 bg-white border-2 border-textself rounded-lg shadow"},[e("div",{class:"relative"},[e("img",{class:"rounded-t-lg object-cover w-full h-[120px]",src:"https://images.unsplash.com/photo-1551024601-bec78aea704b?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8Mnx8ZGVzc2VydHxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=800&q=60",alt:"ImgProduct"}),e("p",{class:"bg-secondary-light px-2 py-1 text-sm font-normal absolute bottom-2 left-2"}," 甜點 ")]),e("div",{class:"p-3 rounded-bl-lg rounded-br-lg"},[e("h2",{class:"font-medium mb-3"},"香草鮮奶酪"),e("div",{class:"flex justify-between items-center"},[e("p",{class:"text-primary-light font-bold"},"$80"),e("p",{class:"font-normal"},[e("span",{class:"text-neutralself-200"},"庫存"),$("  5份 ")])])])])])],-1)),Zt=x(()=>e("section",null,[e("p",{class:"font-medium mb-2"},"已選擇商品"),e("div",{class:"flex flex-wrap"},[e("button",{type:"submit",class:"btn btn-secondary font-medium my-2 mr-2 px-3 py-1 rounded"}," 草莓蛋糕 "),e("button",{type:"submit",class:"btn btn-secondary font-medium my-2 mr-2 px-3 py-1 rounded"}," 巧克力蛋糕 "),e("button",{type:"submit",class:"btn btn-secondary font-medium my-2 mr-2 px-3 py-1 rounded"}," 玫瑰馬卡龍 ")])],-1)),Et=x(()=>e("button",{type:"submit",class:"w-full btn btn-dark"},"確定新增",-1)),Rt=[Ut,Ot,Zt,Et],Yt={key:1,class:"space-y-3",action:"#"},Gt=x(()=>e("h3",{class:"text-xl font-medium text-neutral-400"},[$(" 請確認是否刪除 "),e("span",{class:"text-primary-light"},"買一送一活動"),$(" ? ")],-1)),Wt=x(()=>e("button",{type:"submit",class:"w-full btn btn-dark"},"確認刪除",-1)),Kt=[Gt,Wt],Jt={__name:"FreeOne",setup(u){const c=_(!1),r=_(),y=(m,s)=>{c.value=m;const n=r.value;z(()=>{n&&n.openModal()})},t=()=>{const m=r.value;z(()=>{m&&m.closeModal()})};return(m,s)=>(l(),a(A,null,[e("div",ht,[e("button",{onClick:s[0]||(s[0]=n=>y("create")),class:"btn btn-dark whitespace-nowrap"}," 編輯買一送一活動 ")]),e("section",_t,[e("table",vt,[yt,e("tbody",null,[e("tr",xt,[gt,wt,e("td",Ct,[e("button",{onClick:s[1]||(s[1]=n=>y("delete")),class:"btn btn-outline-dark w-auto mx-1 my-2"}," 刪除 ")])]),e("tr",$t,[kt,Nt,e("td",Tt,[e("button",{onClick:s[2]||(s[2]=n=>y("delete")),class:"btn btn-outline-dark w-auto mx-1 my-2"}," 刪除 ")])]),e("tr",Mt,[Ft,At,e("td",Pt,[e("button",{onClick:s[3]||(s[3]=n=>y("delete")),class:"btn btn-outline-dark w-auto mx-1 my-2"}," 刪除 ")])])])])]),E(W,{ref_key:"childComponentRef",ref:r},{default:Y(()=>[e("section",Lt,[e("div",jt,[e("div",Bt,[c.value==="create"?(l(),a("h2",Dt,"新增買一送一活動")):c.value==="delete"?(l(),a("h2",Vt,"刪除買一送一活動")):j("",!0),e("button",{onClick:s[4]||(s[4]=n=>t()),type:"button",class:"text-gray-400 bg-black hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center"},zt)]),e("div",It,[c.value==="create"?(l(),a("form",qt,Rt)):c.value==="delete"?(l(),a("form",Yt,Kt)):j("",!0)])])])]),_:1},512)],64))}},Xt=G(Jt,[["__scopeId","data-v-aab9e3f6"]]);const B=u=>(ee("data-v-7d396c3a"),u=u(),te(),u),Qt={class:"flex justify-end my-6"},es={class:"overflow-auto bg-bgself-light rounded-xl p-6"},ts={class:"w-full text-center"},ss=B(()=>e("thead",{class:"text-xl font-medium text-secondary-light bg-textself"},[e("tr",{class:"border-b-2 border-black"},[e("th",{class:"py-3"},"分類名稱"),e("th",{class:"py-3"},"優惠代碼"),e("th",{class:"py-3"},"折扣比例"),e("th",{class:"py-3"})])],-1)),os={class:"py-3 text-center"},ls={class:"py-3 text-center"},ns={class:"py-3 text-center"},as={class:"flex justify-end items-center"},cs=["onClick"],ds=["onClick"],is={class:"relative w-full h-full max-w-2xl md:h-auto"},rs={class:"relative bg-white border-2 border-textself rounded-lg shadow"},us={class:"flex items-center justify-end border-b-2 border-textself p-3 rounded-t"},ps={key:0,class:"text-xl font-medium"},ms={key:1,class:"text-xl font-medium"},bs={key:2,class:"text-xl font-medium"},fs=B(()=>e("svg",{"aria-hidden":"true",class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)),hs=B(()=>e("span",{class:"sr-only text-black"},"Close modal",-1)),_s=[fs,hs],vs={class:"w-full rounded-lg p-3"},ys={key:0,class:"space-y-3",action:"#"},xs=B(()=>e("label",{for:"form_discount",class:"block mb-2 font-medium"},"折扣比例 ",-1)),gs={class:"text-sm text-primary-light mt-2"},ws=B(()=>e("p",{class:"font-medium mb-2"},"可選擇的分類",-1)),Cs={class:"flex flex-wrap"},$s=["onClick"],ks=B(()=>e("p",{class:"font-medium mb-2"}," 目前選擇的分類 (必須兩種不重複的分類、點擊黃色按鈕，即刻刪除該分類) ",-1)),Ns={class:"flex flex-wrap"},Ts=["onClick"],Ms=["onClick"],Fs={key:1,class:"space-y-3",action:"#"},As=B(()=>e("label",{for:"form_discount",class:"block mb-2 font-medium"},"折扣比例 ",-1)),Ps={class:"text-sm text-primary-light mt-2"},Ls=["onClick"],js={key:2,class:"space-y-3",action:"#"},Bs={class:"text-xl font-medium text-neutral-400"},Ds={class:"text-primary-light"},Vs=["onClick"],Ss={__name:"FreebiePlus",setup(u){const c=ye();Q(()=>{c.getFreebiePlus()});const{errors:r,useFieldModel:y}=se({validationSchema:oe}),t=_({list:[],discount:y("discount")}),m=_(""),s=_([]),n=_([]),P=le(()=>s.value.filter(b=>b.isChoose===!1)),w=k(async b=>{if(n.value.length>=2){Z("無法加入所選擇的分類，原因是最多兩種不重複的分類");return}else t.value.list.push(b.productsType),n.value.push(b);s.value.forEach(h=>{b.productsType===h.productsType&&(h.isChoose=!0)})}),I=k(async b=>{const h=t.value.list.findIndex(f=>b.productsType===f.productsType),i=n.value.findIndex(f=>b.productsType===f.productsType);t.value.list.splice(h,1),n.value.splice(i,1),s.value.forEach(f=>{b.productsType===f.productsType&&(f.isChoose=!1)})}),q=()=>{if(!t.value.discount){Z("請填寫折扣比例");return}c.postFreebiePlus(t.value),V()},D=()=>{const b={discount:t.value.discount};c.patchFreebiePlus(m.value,b),V()},T=_(""),d=_(""),o=()=>{c.delFreebiePlus(m.value),V()},v=_(!1),L=_(),U=(b,h)=>{v.value=b;const i=L.value;z(()=>{if(i&&i.openModal(),v.value==="create"){const{list:f,availableList:S}=h;f.length!==0&&Object.keys(f[0]).includes("productsTypeA")&&Object.keys(f[0]).includes("productsTypeB")&&f.forEach(N=>{s.value.push({productsType:N.productsTypeA.productsType,productsTypeName:N.productsTypeA.productsTypeName,isChoose:!0},{productsType:N.productsTypeB.productsType,productsTypeName:N.productsTypeB.productsTypeName,isChoose:!0})}),S.length!==0&&S.forEach(N=>{s.value.push({productsType:N.productsType,productsTypeName:N.productsTypeName,isChoose:!1})})}if(v.value==="update"){const{couponNo:f,discount:S}=h;t.value.discount=S,m.value=f}if(v.value==="delete"){const{couponNo:f,productsTypeA:S,productsTypeB:N}=h;T.value=S.productsTypeName,d.value=N.productsTypeName,m.value=f}})},V=()=>{const b=L.value;z(()=>{b&&(b.closeModal(),s.value.length=0,t.value.list.length=0,t.value.discount=0)})};return(b,h)=>(l(),a(A,null,[e("div",Qt,[e("button",{onClick:h[0]||(h[0]=i=>U("create",g(c).freebiePlusList)),class:"btn btn-dark whitespace-nowrap"}," 新增 A + B 優惠活動 ")]),e("section",es,[e("table",ts,[ss,e("tbody",null,[(l(!0),a(A,null,O(g(c).freebiePlusList.list,i=>(l(),a("tr",{class:"border-b-2 border-black",key:i._id},[e("td",os,p(i.productsTypeA.productsTypeName)+" + "+p(i.productsTypeB.productsTypeName),1),e("td",ls,p(i.couponNo),1),e("td",ns,p(i.discount)+"%",1),e("td",as,[e("button",{onClick:f=>U("update",i),class:"btn btn-outline-dark w-auto mx-1 my-2"}," 修改 ",8,cs),e("button",{onClick:f=>U("delete",i),class:"btn btn-outline-dark w-auto mx-1 my-2"}," 刪除 ",8,ds)])]))),128))])])]),E(W,{ref_key:"childComponentRef",ref:L},{default:Y(()=>[e("section",is,[e("div",rs,[e("div",us,[v.value==="create"?(l(),a("h2",ps,"新增 A + B 優惠活動")):v.value==="update"?(l(),a("h2",ms,"修改 A + B 優惠活動")):v.value==="delete"?(l(),a("h2",bs,"刪除 A + B 優惠活動")):j("",!0),e("button",{onClick:h[1]||(h[1]=i=>V()),type:"button",class:"text-gray-400 bg-black hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center"},_s)]),e("div",vs,[v.value==="create"?(l(),a("form",ys,[e("div",null,[xs,C(e("input",{type:"number",name:"discount",id:"form_discount",class:"form-input",placeholder:"請輸入折扣比例","onUpdate:modelValue":h[2]||(h[2]=i=>t.value.discount=i),required:""},null,512),[[M,t.value.discount,void 0,{number:!0}]]),e("p",gs,p(g(r).discount),1)]),e("section",null,[ws,e("div",Cs,[(l(!0),a(A,null,O(g(P),i=>(l(),a("button",{type:"submit",class:"btn btn-primary font-medium my-2 mr-2 px-3 py-1 rounded",key:i.productsType,onClick:F(f=>g(w)(i),["prevent"])},p(i.productsTypeName),9,$s))),128))])]),e("section",null,[ks,e("div",Ns,[(l(!0),a(A,null,O(n.value,i=>(l(),a("button",{type:"submit",class:"btn btn-secondary font-medium my-2 mr-2 px-3 py-1 rounded",key:i.productsType,onClick:F(f=>g(I)(i),["prevent"])},p(i.productsTypeName),9,Ts))),128))])]),e("button",{type:"submit",class:"w-full btn btn-dark",onClick:F(q,["prevent"])}," 確定新增 ",8,Ms)])):j("",!0),v.value==="update"?(l(),a("form",Fs,[e("div",null,[As,C(e("input",{type:"number",name:"discount",id:"form_discount",class:"form-input",placeholder:"請輸入折扣比例","onUpdate:modelValue":h[3]||(h[3]=i=>t.value.discount=i),required:""},null,512),[[M,t.value.discount,void 0,{number:!0}]]),e("p",Ps,p(g(r).discount),1)]),e("button",{type:"submit",class:"w-full btn btn-dark",onClick:F(D,["prevent"])}," 確定修改 ",8,Ls)])):v.value==="delete"?(l(),a("form",js,[e("h3",Bs,[$(" 請確認是否刪除 "),e("span",Ds,p(T.value)+" + "+p(d.value),1),$(" 優惠活動? ")]),e("button",{type:"submit",class:"w-full btn btn-dark",onClick:F(o,["prevent"])}," 確認刪除 ",8,Vs)])):j("",!0)])])])]),_:1},512)],64))}},Hs=G(Ss,[["__scopeId","data-v-7d396c3a"]]),zs=ne({components:{CuponCode:ft,FreeOne:Xt,SiderBar:_e,FreebiePlus:Hs},setup(){return{selectedComponent:_("CuponCode")}}}),Is={class:"fixed top-0 left-0 z-40 w-[315px] h-screen"},qs={class:"ml-[315px] bg-white"},Us=e("nav",{class:"border-b-2 border-textself p-6"},[e("h1",{class:"flex items-center text-[36px] font-bold"},"活動管理")],-1),Os={class:"min-h-screen p-6"},Zs=e("label",{for:"selectCoupon",class:"block mb-2 font-medium whitespace-nowrap"},"活動分類",-1),Es=e("option",{value:"cuponCode"},"優惠碼",-1),Rs=e("option",{value:"freebiePlus"},"A + B 優惠",-1),Ys=[Es,Rs];function Gs(u,c,r,y,t,m){const s=ae("SiderBar");return l(),a(A,null,[e("aside",Is,[E(s)]),e("div",qs,[Us,e("main",Os,[Zs,C(e("select",{id:"selectCoupon",value:"cuponCode","onUpdate:modelValue":c[0]||(c[0]=n=>u.selectedComponent=n),class:"form-select max-w-[250px] py-3"},Ys,512),[[R,u.selectedComponent]]),(l(),K(de,null,[(l(),K(ce(u.selectedComponent)))],1024))])])],64)}const oo=G(zs,[["render",Gs]]);export{oo as default};
